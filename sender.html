<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADAM Signage Sender Panel</title>
<style>
body {
  font-family: system-ui, sans-serif;
  background:#0d1117;
  color:#fff;
  margin:0;
  padding:20px;
}
h1 {
  font-size:1.5rem;
  margin-bottom:10px;
}
.control-bar {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:20px;
}
.control-bar input[type=text] {
  flex:1;
  padding:6px 10px;
  border-radius:4px;
  border:none;
}
.control-bar button {
  padding:6px 12px;
  border:none;
  border-radius:4px;
  background:#007bff;
  color:#fff;
  cursor:pointer;
}
.control-bar button:hover {
  background:#0056b3;
}
.grid {
  display:grid;
  grid-template-columns:repeat(9,1fr);
  gap:4px;
}
.tile {
  background:#222;
  padding:6px;
  border-radius:6px;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.tile input {
  width:100%;
  margin:4px 0;
  padding:4px;
  border-radius:4px;
  border:none;
}
.tile button {
  width:100%;
  margin:2px 0;
  padding:4px;
  border-radius:4px;
  border:none;
  cursor:pointer;
  background:#007bff;
  color:#fff;
}
.tile button:hover {
  background:#0056b3;
}
</style>
</head>
<body>
<h1>ADAM Signage Sender Panel</h1>

<div class="control-bar">
  <input type="text" id="globalUrl" placeholder="Enter URL/YouTube/Image for all tiles">
  <button onclick="broadcastAll()">Broadcast All</button>
  <button onclick="clearAll()">Clear All</button>
</div>

<div class="grid" id="grid"></div>

<script>
const channel = new BroadcastChannel('signage-control');
const tilesData = [];

// Build 9x9 grid
const grid = document.getElementById('grid');
for(let i=0;i<81;i++){
  const tile = document.createElement('div');
  tile.className = 'tile';
  
  const zone = i < 27 ? 'Lobby' : (i < 54 ? 'Shop' : 'Conference');
  const language = i%2===0 ? 'en' : 'hi';

  tile.innerHTML = `
    <div>Screen ${i+1}</div>
    <input id="url${i}" type="text" placeholder="URL/YouTube/Image">
    <button onclick="sendTo(${i})">Send</button>
    <button onclick="goFull(${i})">Full</button>
  `;

  grid.appendChild(tile);
  tilesData.push({zone, language});
}

// YouTube embed helper
function normalizeYouTubeUrl(url){
  if(!url) return '';
  if(url.includes('youtube.com/watch?v=')){
    const id = url.split('v=')[1].split('&')[0];
    return `https://www.youtube.com/embed/${id}?autoplay=1&mute=1`;
  } else if(url.includes('youtu.be/')){
    const id = url.split('youtu.be/')[1];
    return `https://www.youtube.com/embed/${id}?autoplay=1&mute=1`;
  }
  return url;
}

// Per-tile send
function sendTo(index){
  const url = normalizeYouTubeUrl(document.getElementById(`url${index}`).value.trim());
  if(url){
    channel.postMessage({action:'play', index, url});
  }
}

// Per-tile full screen
function goFull(index){
  channel.postMessage({action:'fullscreen', index});
}

// Broadcast all
function broadcastAll(){
  const url = normalizeYouTubeUrl(document.getElementById('globalUrl').value.trim());
  if(url) channel.postMessage({action:'broadcast', url});
}

// Clear all
function clearAll(){
  channel.postMessage({action:'clear'});
}
</script>
</body>
</html>
