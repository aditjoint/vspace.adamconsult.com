<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADAM Enterprise Signage - Admin Panel</title>
<style>
:root { --primary: #007bff; --dark: #222; --light: #f8f9fa; --accent: #6f42c1; }
body { font-family: system-ui, sans-serif; background: var(--dark); color: var(--light); margin: 0; padding: 0; min-height: 100vh; display: flex; flex-direction: column; }
.container { max-width: 1400px; margin: 0 auto; flex: 1; }

/* Header Styles */
.header { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  padding: 15px 20px; 
  background: linear-gradient(135deg, var(--primary), var(--accent)); 
  box-shadow: 0 2px 10px rgba(0,0,0,0.3); 
}
.header h1 { 
  font-size: 1.8rem; 
  color: white; 
  margin: 0; 
  display: flex; 
  align-items: center; 
  gap: 10px; 
}
.header h1 img { 
  height: 40px; 
  border-radius: 8px; 
}
.controls { display: flex; gap: 10px; flex-wrap: wrap; }
button { 
  padding: 8px 12px; 
  border: none; 
  border-radius: 4px; 
  background: rgba(255,255,255,0.2); 
  color: white; 
  cursor: pointer; 
  backdrop-filter: blur(5px); 
  transition: all 0.2s; 
}
button:hover { 
  background: rgba(255,255,255,0.3); 
  transform: translateY(-1px); 
}

/* Main Content */
.main-content { padding: 20px; }

/* Filters */
.filters { 
  display: flex; 
  gap: 15px; 
  margin: 15px 0; 
  flex-wrap: wrap; 
  background: rgba(255,255,255,0.05); 
  padding: 15px; 
  border-radius: 8px; 
  backdrop-filter: blur(5px); 
}
.control-group { 
  display: flex; 
  gap: 5px; 
  align-items: center; 
  background: rgba(255,255,255,0.1); 
  padding: 5px 10px; 
  border-radius: 4px; 
}
label { 
  font-weight: bold; 
  color: rgba(255,255,255,0.9); 
}
input, select { 
  padding: 8px 12px; 
  border: none; 
  border-radius: 4px; 
  background: rgba(255,255,255,0.1); 
  color: white; 
  backdrop-filter: blur(5px); 
}
input[type="text"] { width: 200px; }

/* 9x9 Grid Controls */
.grid-controls { 
  margin: 15px 0; 
  padding: 15px; 
  background: rgba(255,255,255,0.05); 
  border-radius: 8px; 
  backdrop-filter: blur(5px); 
}
.grid-controls h3 { 
  margin: 0 0 10px 0; 
  color: var(--primary); 
}
.grid-url { 
  display: flex; 
  gap: 5px; 
  margin-bottom: 5px; 
  align-items: center; 
}
.grid-url input { 
  flex: 1; 
  background: rgba(255,255,255,0.1); 
  color: white; 
  backdrop-filter: blur(5px); 
}
.grid-url button { 
  width: 80px; 
  background: #dc3545; 
}
.grid-actions { 
  display: flex; 
  gap: 10px; 
  margin-top: 10px; 
}

/* Devices Grid */
.devices-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
  gap: 15px; 
  margin-top: 20px; 
}

/* Device Card */
.device-card { 
  background: #333; 
  padding: 15px; 
  border-radius: 8px; 
  transition: all 0.3s; 
  border: 1px solid rgba(255,255,255,0.1); 
}
.device-card:hover { 
  transform: translateY(-2px); 
  box-shadow: 0 10px 20px rgba(0,0,0,0.3); 
}
.device-header { 
  display: flex; 
  justify-content: space-between; 
  margin-bottom: 10px; 
  padding-bottom: 8px; 
  border-bottom: 1px solid rgba(255,255,255,0.1); 
}
.status { 
  padding: 2px 8px; 
  border-radius: 12px; 
  font-size: 0.8rem; 
}
.online { background: #28a745; }
.offline { background: #dc3545; }
.device-info { 
  margin: 10px 0; 
  font-size: 0.9rem; 
  color: rgba(255,255,255,0.7); 
}
.content-assign { 
  margin-top: 10px; 
  padding-top: 10px; 
  border-top: 1px solid rgba(255,255,255,0.1); 
}
.content-assign input { 
  width: 100%; 
  margin: 5px 0; 
  background: rgba(255,255,255,0.1); 
  color: white; 
  backdrop-filter: blur(5px); 
}
.cast-wall { 
  background: var(--accent); 
  margin-top: 10px; 
  width: 100%; 
}

/* Footer */
.footer { 
  background: rgba(0,0,0,0.5); 
  color: rgba(255,255,255,0.7); 
  text-align: center; 
  padding: 15px; 
  font-size: 0.9rem; 
  border-top: 1px solid rgba(255,255,255,0.1); 
}
.footer a { 
  color: var(--primary); 
  text-decoration: none; 
}
.footer a:hover { 
  text-decoration: underline; 
}
</style>
</head>
<body>
<!-- Header -->
<header class="header">
  <h1>
    <img src="assets/logo.png" alt="ADAM Signage Logo">
    ADAM Enterprise Signage
  </h1>
  <div class="controls">
    <button onclick="refreshDevices()">Refresh</button>
    <button onclick="castToWall()">Cast to Wall</button>
    <button onclick="syncAll()">Sync All</button>
  </div>
</header>

<!-- Main Content -->
<div class="container">
  <div class="main-content">
    <div class="filters">
      <!-- Filters content remains the same -->
      <div class="control-group">
        <label>State:</label>
        <select id="stateFilter" onchange="filterDevices()">
          <option value="all">All States</option>
          <option value="Maharashtra">Maharashtra</option>
          <option value="Tamil Nadu">Tamil Nadu</option>
          <option value="Karnataka">Karnataka</option>
        </select>
      </div>
      <!-- Other filters remain the same -->
    </div>


  <!-- 9x9 Grid Controls -->
  <div class="grid-controls">
    <h3>9x9 Picture-in-Picture Grid</h3>
    <div id="gridUrls">
      <div class="grid-url">
        <input type="text" placeholder="Content URL for Tile 1 (e.g., YouTube, image, video)">
        <button onclick="removeUrl(0)">✕</button>
      </div>
    </div>
    <button onclick="addUrlField()">+ Add URL</button>
    <div class="grid-actions">
      <button onclick="castToGrid()">Cast to 9x9 Grid</button>
      <button onclick="castToGrid(true)">Cast to Grid with Fullscreen</button>
      <select id="fullscreenTile">
        <option value="0">Fullscreen Tile 1</option>
      </select>
    </div>
  </div>

  <div class="devices-grid" id="devicesGrid">
    <!-- Devices will be populated here -->
  </div>
</div>

<script>
// Mock device data - in production, this would come from API
const devices = [
  { id: 'DEV-001', name: 'Corporate Lobby Display', state: 'Maharashtra', region: 'Mumbai Metro', location: 'Corporate Office', language: 'en', status: 'online', ip: '192.168.1.101', model: 'Chromebox' },
  { id: 'DEV-002', name: 'Factory Floor Display', state: 'Maharashtra', region: 'Mumbai Metro', location: 'Factory', language: 'hi', status: 'online', ip: '192.168.1.102', model: 'Chromebit' },
  { id: 'DEV-003', name: 'Retail Store Window', state: 'Maharashtra', region: 'Pune', location: 'Retail Store', language: 'mr', status: 'online', ip: '192.168.1.103', model: 'Chromecast' },
  { id: 'DEV-004', name: 'Conference Room TV', state: 'Tamil Nadu', region: 'Chennai', location: 'Corporate Office', language: 'ta', status: 'offline', ip: '192.168.1.104', model: 'Chromecast' },
  { id: 'DEV-005', name: 'Cafeteria Display', state: 'Karnataka', region: 'Bangalore', location: 'Corporate Office', language: 'en', status: 'online', ip: '192.168.1.105', model: 'Chromebox' }
];

// Initialize devices grid
function initDevices() {
  const grid = document.getElementById('devicesGrid');
  grid.innerHTML = '';
  devices.forEach(device => {
    const card = document.createElement('div');
    card.className = 'device-card';
    card.innerHTML = `
      <div class="device-header">
        <strong>${device.name}</strong>
        <span class="status ${device.status}">${device.status}</span>
      </div>
      <div class="device-info">
        <div>ID: ${device.deviceId || device.id}</div>
        <div>Model: ${device.model}</div>
        <div>IP: ${device.ip}</div>
        <div>Location: ${device.state}, ${device.region}, ${device.location}</div>
        <div>Language: ${device.language}</div>
        ${device.registeredAt ? `<div>Registered: ${new Date(device.registeredAt).toLocaleString()}</div>` : ''}
      </div>
      <div class="content-assign">
        <input type="text" placeholder="Content URL or YouTube" id="content-${device.deviceId || device.id}">
        <button onclick="assignContent('${device.deviceId || device.id}')">Assign</button>
      </div>
      <button class="cast-wall" onclick="castToDevice('${device.deviceId || device.id}')">Cast to Device</button>
    `;
    grid.appendChild(card);
  });
  
  // Initialize grid controls
  updateFullscreenOptions();
}

// Filter devices based on selections
function filterDevices() {
  const state = document.getElementById('stateFilter').value;
  const region = document.getElementById('regionFilter').value;
  const location = document.getElementById('locationFilter').value;
  const language = document.getElementById('languageFilter').value;
  
  const filtered = devices.filter(device => {
    return (state === 'all' || device.state === state) &&
           (region === 'all' || device.region === region) &&
           (location === 'all' || device.location === location) &&
           (language === 'all' || device.language === language);
  });
  
  const grid = document.getElementById('devicesGrid');
  grid.innerHTML = '';
  filtered.forEach(device => {
    const card = document.createElement('div');
    card.className = 'device-card';
    card.innerHTML = `
      <div class="device-header">
        <strong>${device.name}</strong>
        <span class="status ${device.status}">${device.status}</span>
      </div>
      <div class="device-info">
        <div>ID: ${device.deviceId || device.id}</div>
        <div>Model: ${device.model}</div>
        <div>IP: ${device.ip}</div>
        <div>Location: ${device.state}, ${device.region}, ${device.location}</div>
        <div>Language: ${device.language}</div>
        ${device.registeredAt ? `<div>Registered: ${new Date(device.registeredAt).toLocaleString()}</div>` : ''}
      </div>
      <div class="content-assign">
        <input type="text" placeholder="Content URL or YouTube" id="content-${device.deviceId || device.id}">
        <button onclick="assignContent('${device.deviceId || device.id}')">Assign</button>
      </div>
      <button class="cast-wall" onclick="castToDevice('${device.deviceId || device.id}')">Cast to Device</button>
    `;
    grid.appendChild(card);
  });
}

// Assign content to specific device
function assignContent(deviceId) {
  const url = document.getElementById(`content-${deviceId}`).value.trim();
  if (!url) {
    alert('Please enter a URL');
    return;
  }
  // In production, this would send to API
  alert(`Content assigned to ${deviceId}: ${url}`);
}

// Cast to individual device
function castToDevice(deviceId) {
  const device = devices.find(d => d.id === deviceId);
  if (!device || device.status !== 'online') {
    alert('Device is offline or not found');
    return;
  }
  // In production, this would use Cast SDK
  alert(`Casting to ${device.name} (${device.id})`);
}

// Cast to wall (all filtered devices)
function castToWall() {
  const state = document.getElementById('stateFilter').value;
  const region = document.getElementById('regionFilter').value;
  const location = document.getElementById('locationFilter').value;
  const language = document.getElementById('languageFilter').value;
  
  const filtered = devices.filter(device => {
    return (state === 'all' || device.state === state) &&
           (region === 'all' || device.region === region) &&
           (location === 'all' || device.location === location) &&
           (language === 'all' || device.language === language);
  });
  
  const onlineDevices = filtered.filter(d => d.status === 'online');
  if (onlineDevices.length === 0) {
    alert('No online devices found in the selected filters');
    return;
  }
  
  // In production, this would use Cast SDK to cast to multiple devices
  alert(`Casting to wall: ${onlineDevices.length} online devices`);
}

// Add URL field for grid
function addUrlField() {
  const container = document.getElementById('gridUrls');
  const index = container.children.length;
  const div = document.createElement('div');
  div.className = 'grid-url';
  div.innerHTML = `
    <input type="text" placeholder="Content URL for Tile ${index + 1}">
    <button onclick="removeUrl(${index})">✕</button>
  `;
  container.appendChild(div);
  updateFullscreenOptions();
}

// Remove URL field
function removeUrl(index) {
  const container = document.getElementById('gridUrls');
  if (container.children.length > 1) {
    container.removeChild(container.children[index]);
    updateFullscreenOptions();
  }
}

// Update fullscreen tile options
function updateFullscreenOptions() {
  const select = document.getElementById('fullscreenTile');
  const container = document.getElementById('gridUrls');
  const count = container.children.length;
  
  // Save current selection
  const current = select.value;
  
  // Clear options
  select.innerHTML = '';
  
  // Add new options
  for (let i = 0; i < count; i++) {
    const option = document.createElement('option');
    option.value = i;
    option.textContent = `Fullscreen Tile ${i + 1}`;
    select.appendChild(option);
  }
  
  // Restore selection if possible
  if (current < count) {
    select.value = current;
  }
}

// Cast to 9x9 grid
function castToGrid(withFullscreen = false) {
  const urls = [];
  const container = document.getElementById('gridUrls');
  
  for (let i = 0; i < container.children.length; i++) {
    const input = container.children[i].querySelector('input');
    if (input.value.trim()) {
      urls.push(input.value.trim());
    }
  }
  
  if (urls.length === 0) {
    alert('Please add at least one URL');
    return;
  }
  
  const fullscreenTile = withFullscreen ? parseInt(document.getElementById('fullscreenTile').value) : undefined;
  
  // In production, this would use Cast SDK
  const message = withFullscreen ? 
    `Casting to 9x9 grid with ${urls.length} sources. Fullscreen on Tile ${fullscreenTile + 1}` :
    `Casting to 9x9 grid with ${urls.length} sources`;
  
  alert(message);
}

// Refresh devices (simulated)
function refreshDevices() {
  // In production, this would fetch from API
  alert('Refreshing device status...');
}

// Sync all devices
function syncAll() {
  // In production, this would sync configuration
  alert('Syncing all devices...');
}

// Handle device registration from receivers
if (typeof BroadcastChannel !== 'undefined') {
  const channel = new BroadcastChannel('device-registration');
  channel.onmessage = function(event) {
    if (event.data.action === 'register') {
      // Add new device to the list
      const newDevice = {
        ...event.data.device,
        status: 'online'
      };
      
      // Check if device already exists
      const existingIndex = devices.findIndex(d => d.id === newDevice.deviceId);
      if (existingIndex >= 0) {
        // Update existing device
        devices[existingIndex] = newDevice;
      } else {
        // Add new device
        devices.push(newDevice);
      }
      
      // Refresh the device list
      initDevices();
      console.log('Device registered:', newDevice);
    }
  };
}


// Add setup link to header
document.querySelector('.header').insertAdjacentHTML('beforeend', `
  <div style="margin-left: 20px;">
    <button onclick="openSetup()" style="background: #6c757d;">Device Setup</button>
  </div>
`);

function openSetup() {
  // Create setup form in a popup
  const setupForm = `
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 10000;" id="setupOverlay">
      <div style="background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 500px;">
        <h2 style="color: #007bff; margin-top: 0;">Device Configuration</h2>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">Device Name</label>
          <input type="text" id="setupDeviceName" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" value="${localStorage.getItem('deviceName') || ''}">
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">State</label>
          <select id="setupState" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <option value="Maharashtra" ${localStorage.getItem('state') === 'Maharashtra' ? 'selected' : ''}>Maharashtra</option>
            <option value="Tamil Nadu" ${localStorage.getItem('state') === 'Tamil Nadu' ? 'selected' : ''}>Tamil Nadu</option>
            <option value="Karnataka" ${localStorage.getItem('state') === 'Karnataka' ? 'selected' : ''}>Karnataka</option>
          </select>
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">Region</label>
          <select id="setupRegion" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <option value="Mumbai Metro" ${localStorage.getItem('region') === 'Mumbai Metro' ? 'selected' : ''}>Mumbai Metro</option>
            <option value="Pune" ${localStorage.getItem('region') === 'Pune' ? 'selected' : ''}>Pune</option>
            <option value="Chennai" ${localStorage.getItem('region') === 'Chennai' ? 'selected' : ''}>Chennai</option>
          </select>
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">Location</label>
          <select id="setupLocation" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <option value="Corporate Office" ${localStorage.getItem('location') === 'Corporate Office' ? 'selected' : ''}>Corporate Office</option>
            <option value="Retail Store" ${localStorage.getItem('location') === 'Retail Store' ? 'selected' : ''}>Retail Store</option>
            <option value="Factory" ${localStorage.getItem('location') === 'Factory' ? 'selected' : ''}>Factory</option>
          </select>
        </div>
        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">Language</label>
          <select id="setupLanguage" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <option value="en" ${localStorage.getItem('language') === 'en' ? 'selected' : ''}>English</option>
            <option value="hi" ${localStorage.getItem('language') === 'hi' ? 'selected' : ''}>Hindi</option>
            <option value="mr" ${localStorage.getItem('language') === 'mr' ? 'selected' : ''}>Marathi</option>
            <option value="ta" ${localStorage.getItem('language') === 'ta' ? 'selected' : ''}>Tamil</option>
          </select>
        </div>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
          <button onclick="saveSetup()" style="flex: 1; background: #007bff; color: white; padding: 10px; border: none; border-radius: 4px; cursor: pointer;">Save</button>
          <button onclick="closeSetup()" style="flex: 1; background: #6c757d; color: white; padding: 10px; border: none; border-radius: 4px; cursor: pointer;">Cancel</button>
        </div>
      </div>
    </div>
  `;
  
  document.body.insertAdjacentHTML('beforeend', setupForm);
}

function saveSetup() {
  // Save to localStorage
  localStorage.setItem('deviceName', document.getElementById('setupDeviceName').value);
  localStorage.setItem('state', document.getElementById('setupState').value);
  localStorage.setItem('region', document.getElementById('setupRegion').value);
  localStorage.setItem('location', document.getElementById('setupLocation').value);
  localStorage.setItem('language', document.getElementById('setupLanguage').value);
  
  alert('Configuration saved! Restart the receiver to apply changes.');
  closeSetup();
}

function closeSetup() {
  const overlay = document.getElementById('setupOverlay');
  if (overlay) {
    overlay.remove();
  }
}

// Add device ID to the device card display
function initDevices() {
  const grid = document.getElementById('devicesGrid');
  grid.innerHTML = '';
  devices.forEach(device => {
    const card = document.createElement('div');
    card.className = 'device-card';
    card.innerHTML = `
      <div class="device-header">
        <strong>${device.name}</strong>
        <span class="status ${device.status}">${device.status}</span>
      </div>
      <div class="device-info">
        <div>ID: ${device.deviceId || device.id}</div>
        <div>Model: ${device.model}</div>
        <div>IP: ${device.ip}</div>
        <div>Location: ${device.state}, ${device.region}, ${device.location}</div>
        <div>Language: ${device.language}</div>
        ${device.registeredAt ? `<div>Registered: ${new Date(device.registeredAt).toLocaleString()}</div>` : ''}
      </div>
      <div class="content-assign">
        <input type="text" placeholder="Content URL or YouTube" id="content-${device.deviceId || device.id}">
        <button onclick="assignContent('${device.deviceId || device.id}')">Assign</button>
      </div>
      <button class="cast-wall" onclick="castToDevice('${device.deviceId || device.id}')">Cast to Device</button>
    `;
    grid.appendChild(card);
  });
}
</script>

  

<!-- Footer -->
<footer class="footer">
  <p>ADAM Enterprise Signage System &copy; 2025 | 
     <a href="https://adamconsult.com" target="_blank">adamconsult.com</a> | 
     Version 1.0.0</p>
</footer>

<script>
// Rest of the JavaScript remains the same as previous implementation
// Mock device data - in production, this would come from API
const devices = [
  { id: 'DEV-001', name: 'Corporate Lobby Display', state: 'Maharashtra', region: 'Mumbai Metro', location: 'Corporate Office', language: 'en', status: 'online', ip: '192.168.1.101', model: 'Chromebox' },
  { id: 'DEV-002', name: 'Factory Floor Display', state: 'Maharashtra', region: 'Mumbai Metro', location: 'Factory', language: 'hi', status: 'online', ip: '192.168.1.102', model: 'Chromebit' },
  { id: 'DEV-003', name: 'Retail Store Window', state: 'Maharashtra', region: 'Pune', location: 'Retail Store', language: 'mr', status: 'online', ip: '192.168.1.103', model: 'Chromecast' },
  { id: 'DEV-004', name: 'Conference Room TV', state: 'Tamil Nadu', region: 'Chennai', location: 'Corporate Office', language: 'ta', status: 'offline', ip: '192.168.1.104', model: 'Chromecast' },
  { id: 'DEV-005', name: 'Cafeteria Display', state: 'Karnataka', region: 'Bangalore', location: 'Corporate Office', language: 'en', status: 'online', ip: '192.168.1.105', model: 'Chromebox' }
];

// Initialize devices grid
function initDevices() {
  const grid = document.getElementById('devicesGrid');
  grid.innerHTML = '';
  devices.forEach(device => {
    const card = document.createElement('div');
    card.className = 'device-card';
    card.innerHTML = `
      <div class="device-header">
        <strong>${device.name}</strong>
        <span class="status ${device.status}">${device.status}</span>
      </div>
      <div class="device-info">
        <div>ID: ${device.deviceId || device.id}</div>
        <div>Model: ${device.model}</div>
        <div>IP: ${device.ip}</div>
        <div>Location: ${device.state}, ${device.region}, ${device.location}</div>
        <div>Language: ${device.language}</div>
        ${device.registeredAt ? `<div>Registered: ${new Date(device.registeredAt).toLocaleString()}</div>` : ''}
      </div>
      <div class="content-assign">
        <input type="text" placeholder="Content URL or YouTube" id="content-${device.deviceId || device.id}">
        <button onclick="assignContent('${device.deviceId || device.id}')">Assign</button>
      </div>
      <button class="cast-wall" onclick="castToDevice('${device.deviceId || device.id}')">Cast to Device</button>
    `;
    grid.appendChild(card);
  });
    // Initialize grid controls
  updateFullscreenOptions();
}

// Initialize on load
window.onload = initDevices;
</script>

</body>
</html>
