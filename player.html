<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADAM Signage Player</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
body, html { 
  margin: 0; 
  padding: 0; 
  width: 100%; 
  height: 100%; 
  overflow: hidden; 
  background: #000; 
}
.grid-container { 
  display: grid; 
  grid-template-columns: repeat(9, 1fr); 
  grid-template-rows: repeat(9, 1fr); 
  width: 100%; 
  height: 100%; 
  gap: 2px; 
}
.grid-item { 
  background: #111; 
  position: relative; 
  overflow: hidden; 
}
.grid-item video, 
.grid-item img, 
.grid-item iframe { 
  width: 100%; 
  height: 100%; 
  object-fit: contain; 
}
.grid-item::after {
  content: attr(data-index);
  position: absolute;
  bottom: 4px;
  right: 4px;
  background: rgba(0,0,0,0.8);
  color: #0d6efd;
  font-size: 12px;
  font-weight: bold;
  padding: 2px 6px;
  border-radius: 3px;
}
</style>
</head>
<body>
<div class="grid-container" id="grid"></div>

<script>
const grid = document.getElementById('grid');
const tiles = [];

// Create 9x9 grid
for (let i = 0; i < 81; i++) {
  const tile = document.createElement('div');
  tile.className = 'grid-item';
  tile.setAttribute('data-index', i + 1);
  grid.appendChild(tile);
  tiles.push(tile);
}

// Load playlist
fetch('playlist.json')
  .then(res => res.json())
  .then(playlist => {
    playlist.tiles.forEach((item, index) => {
      if (index < 81 && item.url) {
        loadContent(tiles[index], item.url);
      }
    });
  })
  .catch(err => console.error('Error loading playlist:', err));

function loadContent(container, url) {
  // Same loadContent function as receiver.html
  if (url.includes('youtube.com') || url.includes('youtu.be')) {
    let videoId = '';
    if (url.includes('v=')) {
      videoId = url.split('v=')[1].split('&')[0];
    } else if (url.includes('youtu.be/')) {
      videoId = url.split('youtu.be/')[1].split('?')[0];
    }
    
    if (videoId) {
      const iframe = document.createElement('iframe');
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&loop=1`;
      iframe.allow = 'autoplay; encrypted-media';
      container.appendChild(iframe);
    }
  } else if (url.match(/\.(jpeg|jpg|gif|png|bmp)$/i)) {
    const img = document.createElement('img');
    img.src = url;
    container.appendChild(img);
  } else if (url.match(/\.(mp4|webm|ogg)$/i)) {
    const video = document.createElement('video');
    video.src = url;
    video.autoplay = true;
    video.muted = true;
    video.loop = true;
    container.appendChild(video);
  }
}
</script>
</body>
</html>
